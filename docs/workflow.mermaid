sequenceDiagram
    participant Dev as Developer
    participant CLI as CodeFlow-Hook
    participant RAG as Vector Store
    participant LLM as AI Provider
    participant Sentry as Sentinel (Runtime)

    Note over Dev, CLI: Development Phase
    Dev->>CLI: git commit -m "feat: new login"
    CLI->>CLI: Load Config (Project > Global)
    CLI->>CLI: Run Compliance Scan (GDPR/HIPAA)
    alt Violation Detected
        CLI-->>Dev: ðŸš¨ BLOCK COMMIT (PII Found)
    else Safe to Proceed
        CLI->>RAG: Fetch Context (Similar Files)
        RAG-->>CLI: Return Context
        CLI->>LLM: Analyze Diff + Context
        LLM-->>CLI: Review & Rating
        CLI-->>Dev: âœ… Commit Allowed
    end

    Note over Sentry, LLM: Runtime Phase
    Sentry->>Sentry: Monitor Traffic (Latency/Input)
    Sentry->>Sentry: Update ML Model (IsolationForest)
    alt Anomaly Detected
        Sentry->>LLM: "Explain this behavior"
        LLM-->>Sentry: "Likely Brute Force Attack"
        Sentry->>Sentry: Trigger Lockdown
    end
